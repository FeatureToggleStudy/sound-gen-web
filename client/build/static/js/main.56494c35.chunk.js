(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{241:function(e,t,a){},251:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(22),o=a.n(i),r=(a(90),a(9)),l=a(7),c=a(11),u=a(10),_=a(12),h=a(84),d=a.n(h),p=a(51),v=a(23),m=a(78),y=a.n(m),f=a(33),E=a(42),b=a.n(E),g=a(41),k=a.n(g),P={wrapper:{margin:"auto",maxWidth:700},slider:{padding:"22px 0px",margin:"auto",maxWidth:600,touchAction:"none"},label:{color:"white"}},S=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){a.setState({value:t}),a.props.handleChange({pitch:t})},a.state={value:60},a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=s.a.createElement("div",null,s.a.createElement(k.a,{id:"label",style:P.label},"Pitch"),s.a.createElement(b.a,{style:P.slider,value:this.state.value,min:this.props.min,max:this.props.max,step:this.props.step,onChange:this.handleChange}));return s.a.createElement("div",{style:P.wrapper},e)}}]),t}(n.Component),M=Object(f.withStyles)(P)(S),w={wrapper:{margin:"auto",maxWidth:700},slider:{padding:"22px 0px",margin:"auto",maxWidth:600,touchAction:"none"},label:{color:"white"}},C=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e,t){a.setState({value:t}),a.props.handleChange({velocity:t})},a.state={value:50},a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=s.a.createElement("div",null,s.a.createElement(k.a,{id:"label",style:w.label},"Velocity"),s.a.createElement(b.a,{style:w.slider,value:this.state.value,min:this.props.min,max:this.props.max,onChange:this.handleChange}));return s.a.createElement("div",{style:w.wrapper},e)}}]),t}(n.Component),x=(Object(f.withStyles)(w)(C),a(3)),O={wrapper:{},key:{width:"100%",paddingLeft:0,paddingRight:0}},D=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).config={},a.state={isActive:!1,color:"default"},a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"updateKeyPressed",value:function(e){this.props.updateKeyPressed({key:this.props.label,pitch:this.props.pitch,active:e})}},{key:"handleMouseEnter",value:function(){this.setState({color:"info"})}},{key:"handleMouseOut",value:function(){this.setState({color:"default"}),this.setState({isActive:!1})}},{key:"handleMouseDown",value:function(){this.setState({isActive:!0}),this.updateKeyPressed(!0)}},{key:"handleMouseUp",value:function(){this.setState({isActive:!1}),this.updateKeyPressed(!1)}},{key:"handleKeyDown",value:function(e){e.key.toLowerCase()===this.props.label.toLowerCase()&&(!0!==this.state.isActive&&this.updateKeyPressed(!0),this.setState({isActive:!0}),this.setState({color:"info"}))}},{key:"handleKeyUp",value:function(e){e.key.toLowerCase()===this.props.label.toLowerCase()&&(this.setState({isActive:!1}),this.setState({color:"default"}),this.updateKeyPressed(!1))}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown.bind(this),!1),document.addEventListener("keyup",this.handleKeyUp.bind(this),!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown.bind(this),!1),document.removeEventListener("key",this.handleKeyUp.bind(this),!1)}},{key:"render",value:function(){var e=s.a.createElement(x.MDBBtn,{style:O.key,outline:!this.state.isActive,color:this.state.color,onMouseDown:this.handleMouseDown.bind(this),onMouseUp:this.handleMouseUp.bind(this),onMouseEnter:this.handleMouseEnter.bind(this),onMouseOut:this.handleMouseOut.bind(this),size:"sm"},this.props.label);return s.a.createElement("div",{style:O.wrapper},e)}}]),t}(n.Component),j={wrapper:{},keyboardTop:{position:"relative",left:88},keyboardBottom:{position:"relative",left:40}},B=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).config={},a.state={isActive:!1,color:"default"},a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=s.a.createElement(x.MDBContainer,null,s.a.createElement(x.MDBRow,{style:j.keyboardTop},s.a.createElement(x.MDBCol,{xs:"2"}),s.a.createElement(x.MDBCol,{sm:"1"},s.a.createElement(D,{label:"W",pitch:40,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{sm:"1"},s.a.createElement(D,{label:"E",pitch:48,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{sm:"1"},s.a.createElement(D,{label:"R",pitch:56,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{sm:"1"},s.a.createElement(D,{label:"T",pitch:64,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{sm:"1"},s.a.createElement(D,{label:"Y",pitch:72,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"U",pitch:80,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"2"})),s.a.createElement(x.MDBRow,{style:j.keyboardBottom},s.a.createElement(x.MDBCol,{xs:"2"}),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"A",pitch:36,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"S",pitch:44,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"D",pitch:52,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"F",pitch:60,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"G",pitch:68,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"H",pitch:76,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"1"},s.a.createElement(D,{label:"J",pitch:84,updateKeyPressed:this.props.updateKeyPressed})),s.a.createElement(x.MDBCol,{xs:"2"})));return s.a.createElement("div",{style:j.wrapper},e)}}]),t}(n.Component),K=a(81),W={wrapper:{maxWidth:700,margin:"auto"},sketchArea:{border:"1px solid white",maxWidth:600,height:400,margin:"auto"},soundLeft:{fontSize:16,textAlign:"left",padding:10},soundRight:{fontSize:16,textAlign:"right",padding:10}},R=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={updateInterval:500,notConfiguredText:"Not Configured",currentPosX:0,currentPosY:0,targetPosX:0,targetPosY:0,currentPercentX:0,currentPercentY:0,canvasWidth:0,canvasHeight:0,easing:.06,circleRadius:30,isMoving:!1,sentLastPos:!1,soundNW:"",soundNE:"",soundSW:"",soundSE:"",isActive:!1,hasBeenActivated:!1},a.sketchRef=s.a.createRef(),a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"updateLatentSelector",value:function(){!0!==this.state.isMoving&&!0!==this.state.isActive||this.setState({sentLastPos:!1}),!0!==this.state.sentLastPos&&(this.props.updateLatentSelector({x:this.state.currentPercentX,y:this.state.currentPercentY,hasBeenActivated:this.state.hasBeenActivated}),this.setState({sentLastPos:!0}))}},{key:"calcPercent",value:function(){var e=this.state.currentPosX/this.state.canvasWidth,t=this.state.currentPosY/this.state.canvasHeight;e>1&&(e=1),e<0&&(e=0),t>1&&(t=1),t<0&&(t=0),this.setState({currentPercentX:e,currentPercentY:t})}},{key:"updateCanvasSize",value:function(){var e=this.sketchRef.current.offsetHeight,t=this.sketchRef.current.offsetWidth;this.setState({canvasWidth:t,canvasHeight:e})}},{key:"redrawCanvas",value:function(){var e=this.state.canvasHeight,t=this.state.canvasWidth;this.updateCanvasSize();var a=this.state.canvasHeight,n=(this.state.canvasWidth-t)/2,s=(a-e)/2;this.setState({currentPosX:this.state.currentPosX+n,currentPosY:this.state.currentPosY+s,targetX:this.state.targetX+n,targetY:this.state.targetY+s}),this.p5.resizeCanvas(this.state.canvasWidth,this.state.canvasHeight),this.p5.redraw()}},{key:"updateSounds",value:function(){var e=this.props.sounds;this.setState({soundNW:e.find(function(e){return"NW"===e.position})||{name:this.state.notConfiguredText},soundNE:e.find(function(e){return"NE"===e.position})||{name:this.state.notConfiguredText},soundSW:e.find(function(e){return"SW"===e.position})||{name:this.state.notConfiguredText},soundSE:e.find(function(e){return"SE"===e.position})||{name:this.state.notConfiguredText}})}},{key:"initP5",value:function(e){var t=this;this.setState({targetX:this.sketchRef.current.offsetWidth/2,targetY:this.sketchRef.current.offsetHeight/2}),this.sk.setup=function(){var e=t.sk.createCanvas(t.state.canvasWidth,t.state.canvasHeight);t.sk.noStroke(),e.parent(t.sketchRef.current.id)},this.sk.draw=function(){var e,a,n=0,s=1;t.sk.clear(),t.sk.mouseIsPressed&&t.sk.mouseX>=0&&t.sk.mouseX<=t.state.canvasWidth&&t.sk.mouseY>=0&&t.sk.mouseY<=t.state.canvasHeight&&t.setState({targetX:t.sk.mouseX,targetY:t.sk.mouseY}),a=t.state.targetY-t.state.currentPosY,e=t.state.targetX-t.state.currentPosX,t.setState({currentPosX:t.state.currentPosX+e*t.state.easing,currentPosY:t.state.currentPosY+a*t.state.easing}),Math.abs(a)>.5||Math.abs(e)>.5?t.setState({isMoving:!0}):t.setState({isMoving:!1}),!0===t.state.isMoving&&t.calcPercent();for(var i=0;i<t.state.circleRadius;i+=s)!0===t.state.isMoving?(n=Math.floor(5*Math.random()*Math.max(Math.abs(e),Math.abs(a))),s=2,t.sk.stroke(37+n,175+n,180+n),t.sk.strokeWeight(1)):(s=5,t.sk.stroke(37+n,175+n,180+n),t.sk.strokeWeight(3)),t.sk.noFill(),t.sk.ellipse(t.state.currentPosX,t.state.currentPosY,i,i)}}},{key:"handleMouseDown",value:function(){this.setState({isActive:!0}),this.setState({hasBeenActivated:!0})}},{key:"handleMouseUp",value:function(){this.setState({isActive:!1})}},{key:"handleTouchStart",value:function(){this.setState({isActive:!0}),this.setState({hasBeenActivated:!0})}},{key:"handleMouseEnd",value:function(){this.setState({isActive:!1})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.redrawCanvas.bind(this)),window.addEventListener("touchend",this.handleMouseUp.bind(this)),window.addEventListener("mouseup",this.handleMouseUp.bind(this)),setInterval(this.updateLatentSelector.bind(this),this.state.updateInterval),this.s=function(t){e.sk=t,e.updateSounds(),e.updateCanvasSize(),e.initP5()},this.p5=new K(this.s)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.redrawCanvas),window.addEveremoveEventListenerntListener("touchend",this.handleMouseUp),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=s.a.createElement(x.MDBContainer,null,s.a.createElement(x.MDBRow,null,s.a.createElement(x.MDBCol,{xs:"6",style:W.soundLeft},this.state.soundNW.name),s.a.createElement(x.MDBCol,{xs:"6",style:W.soundRight},this.state.soundNE.name)),s.a.createElement(x.MDBRow,null,s.a.createElement(x.MDBCol,{xs:"12"},s.a.createElement("div",{id:"sketch-area",ref:this.sketchRef,style:W.sketchArea,onMouseDown:this.handleMouseDown.bind(this),onMouseUp:this.handleMouseUp.bind(this)}))),s.a.createElement(x.MDBRow,null,s.a.createElement(x.MDBCol,{xs:"6",style:W.soundLeft},this.state.soundSW.name),s.a.createElement(x.MDBCol,{xs:"6",style:W.soundRight},this.state.soundSE.name)));return s.a.createElement("div",{style:W.wrapper},e)}}]),t}(n.Component),A={content:{padding:20,width:"100%"}},L=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).config={fileUrl:{storagePath:"https://storage.googleapis.com",bucket:"augmented-music-generation-dev",folderPath:"/latent_grids/test",gridName:"cleaned_grid_v3"},pitches:[{key:"A",value:36},{key:"W",value:40},{key:"S",value:44},{key:"E",value:48},{key:"D",value:52},{key:"R",value:56},{key:"F",value:60},{key:"T",value:64},{key:"G",value:68},{key:"Y",value:72},{key:"H",value:76},{key:"U",value:80},{key:"J",value:84}]},a.state={loading:!0,serverError:!1,latentRatioNW:0,latentRatioNE:0,latentRatioSW:0,latentRatioSE:0,pitch:60,velocity:.5},a.handlePlayerError=a.handlePlayerError.bind(Object(v.a)(Object(v.a)(a))),a.handlePlayerReady=a.handlePlayerReady.bind(Object(v.a)(Object(v.a)(a))),a.soundUrls={},a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"handlePlayerReady",value:function(){console.log("player ready"),this.setState({loading:!1})}},{key:"handlePlayerError",value:function(e){console.log("player error")}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.data.latentSpaces,a="".concat(this.config.fileUrl.storagePath,"/").concat(this.config.fileUrl.bucket);t.forEach(function(t){e.config.pitches.forEach(function(n){var s="".concat(t,"_pitch_").concat(n.value),i="".concat(a).concat(e.config.fileUrl.folderPath,"/").concat(e.config.fileUrl.gridName,"_").concat(s,"_vel_127.mp3");e.soundUrls[s]=i})}),this.buffers=new y.a.Buffers(this.soundUrls,function(){console.log("buffers:done"),e.setState({loading:!1})})}},{key:"updatePitch",value:function(e){var t=this;this.setState({pitch:e.pitch},function(){t.playSound()})}},{key:"updateVelocity",value:function(e){var t=this;this.setState({velocity:e.velocity/100},function(){t.playSound()})}},{key:"playSound",value:function(){var e=this.state.pitch,t="".concat(this.state.latentRatioNW)+"_".concat(this.state.latentRatioNE)+"_".concat(this.state.latentRatioSW)+"_".concat(this.state.latentRatioSE);if(this.players){var a=t+"_pitch_"+e,n=this.players.get(a);if(n)try{n.start()}catch(s){console.log("error playing sound: "+a)}else console.log("does not exist: "+a)}}},{key:"updateKeyPressed",value:function(e){var t=this,a=e.pitch;!0===e.active&&this.setState({pitch:a},function(){t.playSound()})}},{key:"updateLatentSelector",value:function(e){for(var t=this,a=parseFloat(e.x).toFixed(1),n=parseFloat(e.y).toFixed(1),s=e.hasBeenActivated,i=[Math.round(10*(1-a)*(1-n))/10,Math.round(10*a*(1-n))/10,Math.round(10*(1-a)*n)/10,Math.round(10*a*n)/10],o=i.reduce(function(e,t){return e+t}),r=0;1!==o&&10!==r;){if(o<1){var l=i.indexOf(Math.max.apply(Math,Object(p.a)(i)));i[l]+=.1}if(o>1){var c=i.indexOf(Math.max.apply(Math,Object(p.a)(i)));i[c]-=.1}o=i.reduce(function(e,t){return e+t}),r++}i=i.map(function(e){return parseFloat(e).toFixed(1)}),this.setState({latentRatioNW:i[0],latentRatioNE:i[1],latentRatioSW:i[2],latentRatioSE:i[3]},function(){!0===s&&t.playSound()})}},{key:"render",value:function(){var e;return e=!0===this.state.loading?s.a.createElement("div",{className:"loader border-top-default medium fast"}):!0===this.state.serverError?s.a.createElement("div",null,"Server Unreachable",s.a.createElement("br",null),s.a.createElement("br",null),"Try Reloading App"):s.a.createElement("div",null,s.a.createElement(R,{updateLatentSelector:this.updateLatentSelector.bind(this),sounds:this.props.data.sounds}),s.a.createElement("br",null),s.a.createElement(M,{min:36,max:84,step:4,handleChange:this.updatePitch.bind(this)}),s.a.createElement("br",null),s.a.createElement("div",{className:"d-none d-lg-block"},s.a.createElement(B,{updateKeyPressed:this.updateKeyPressed.bind(this)}))),s.a.createElement("div",{style:A.content},e)}}]),t}(n.Component),U=a(82),N=a(83),Y=(a(241),{latentSpaces:N,sounds:[{name:"Strings",position:"NW"},{name:"Bells",position:"NE"},{name:"Synth",position:"SW"},{name:"Guitar",position:"SE"}]}),X=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).appState=U.a.object({}),a}return Object(_.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,null),s.a.createElement("div",{className:"App"},s.a.createElement("main",{className:"App-main"},s.a.createElement(L,{data:Y}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(244),a(246),a(248);o.a.render(s.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},83:function(e){e.exports=["0.0_0.0_0.0_1.0","0.0_0.0_0.1_0.9","0.0_0.0_0.2_0.8","0.0_0.0_0.3_0.7","0.0_0.0_0.4_0.6","0.0_0.0_0.5_0.5","0.0_0.0_0.6_0.4","0.0_0.0_0.7_0.3","0.0_0.0_0.8_0.2","0.0_0.0_0.9_0.1","0.0_0.0_1.0_0.0","0.0_0.1_0.0_0.9","0.0_0.1_0.1_0.8","0.0_0.1_0.2_0.7","0.0_0.1_0.3_0.6","0.0_0.1_0.4_0.5","0.0_0.2_0.0_0.8","0.0_0.2_0.1_0.7","0.0_0.2_0.2_0.6","0.0_0.3_0.0_0.7","0.0_0.3_0.1_0.6","0.0_0.4_0.0_0.6","0.0_0.4_0.1_0.5","0.0_0.5_0.0_0.5","0.0_0.6_0.0_0.4","0.0_0.7_0.0_0.3","0.0_0.8_0.0_0.2","0.0_0.9_0.0_0.1","0.0_1.0_0.0_0.0","0.1_0.0_0.5_0.4","0.1_0.0_0.6_0.3","0.1_0.0_0.7_0.2","0.1_0.0_0.8_0.1","0.1_0.0_0.9_0.0","0.1_0.1_0.2_0.6","0.1_0.1_0.3_0.5","0.1_0.1_0.4_0.4","0.1_0.1_0.5_0.3","0.1_0.1_0.6_0.2","0.1_0.2_0.1_0.6","0.1_0.2_0.2_0.5","0.1_0.2_0.3_0.4","0.1_0.3_0.1_0.5","0.1_0.3_0.2_0.4","0.1_0.4_0.1_0.4","0.1_0.5_0.0_0.4","0.1_0.5_0.1_0.3","0.1_0.6_0.0_0.3","0.1_0.6_0.1_0.2","0.1_0.7_0.0_0.2","0.1_0.8_0.0_0.1","0.1_0.9_0.0_0.0","0.2_0.0_0.6_0.2","0.2_0.0_0.7_0.1","0.2_0.0_0.8_0.0","0.2_0.1_0.4_0.3","0.2_0.1_0.5_0.2","0.2_0.1_0.6_0.1","0.2_0.2_0.2_0.2","0.2_0.2_0.2_0.4","0.2_0.2_0.3_0.3","0.2_0.2_0.4_0.2","0.2_0.3_0.2_0.3","0.2_0.4_0.1_0.3","0.2_0.4_0.2_0.2","0.2_0.5_0.1_0.2","0.2_0.6_0.0_0.2","0.2_0.6_0.1_0.1","0.2_0.7_0.0_0.1","0.2_0.8_0.0_0.0","0.3_0.0_0.6_0.1","0.3_0.0_0.7_0.0","0.3_0.1_0.4_0.2","0.3_0.1_0.5_0.1","0.3_0.2_0.3_0.2","0.3_0.3_0.2_0.2","0.3_0.4_0.1_0.2","0.3_0.5_0.1_0.1","0.3_0.6_0.0_0.1","0.3_0.7_0.0_0.0","0.4_0.0_0.5_0.1","0.4_0.0_0.6_0.0","0.4_0.1_0.4_0.1","0.4_0.2_0.2_0.2","0.4_0.2_0.3_0.1","0.4_0.3_0.2_0.1","0.4_0.4_0.1_0.1","0.4_0.5_0.0_0.1","0.4_0.6_0.0_0.0","0.5_0.0_0.5_0.0","0.5_0.1_0.3_0.1","0.5_0.1_0.4_0.0","0.5_0.1_0.5_0.1","0.5_0.2_0.2_0.1","0.5_0.3_0.1_0.1","0.5_0.4_0.1_0.0","0.5_0.5_0.0_0.0","0.5_0.5_0.1_0.1","0.6_0.0_0.4_0.0","0.6_0.1_0.2_0.1","0.6_0.1_0.3_0.0","0.6_0.2_0.1_0.1","0.6_0.2_0.2_0.0","0.6_0.3_0.1_0.0","0.6_0.4_0.0_0.0","0.7_0.0_0.3_0.0","0.7_0.1_0.2_0.0","0.7_0.2_0.1_0.0","0.7_0.3_0.0_0.0","0.8_0.0_0.2_0.0","0.8_0.1_0.1_0.0","0.8_0.2_0.0_0.0","0.9_0.0_0.1_0.0","0.9_0.1_0.0_0.0","1.0_0.0_0.0_0.0"]},85:function(e,t,a){e.exports=a(251)},90:function(e,t,a){}},[[85,2,1]]]);
//# sourceMappingURL=main.56494c35.chunk.js.map